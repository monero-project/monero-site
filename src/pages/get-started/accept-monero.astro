---
import Accordion from "@/components/ui/Accordion.astro";
import AccordionItem from "@/components/ui/AccordionItem.astro";
import ExternalResourceButton from "@/components/ui/ExternalResourceButton.astro";
import IconLink from "@/components/ui/IconLink.astro";
import PageContainer from "@/components/ui/PageContainer.astro";
import TitleCard from "@/components/ui/TitleCard.astro";
import Layout from "@/layouts/Layout.astro";

import GuideStep from "@/components/pages/accept-monero/GuideStep.astro";
import TipBox from "@/components/pages/accept-monero/TipBox.astro";

import appWindowIcon from "@/assets/icons/mask/app-window.avif";
import handCoinsIcon from "@/assets/icons/mask/handCoins.avif";
import usersIcon from "@/assets/icons/mask/users.avif";

const { t, localizeHref, localizeNumber } = Astro.locals;
---

<Layout
  title={t("accept-monero:pageTitle")}
  description={t("accept-monero:description")}
>
  <TitleCard
    title={t("accept-monero:title")}
    subtitle={t("accept-monero:subtitle")}
  />

  <PageContainer>
    <div class="guide-content">
      <GuideStep
        step={localizeNumber(1)}
        title={t("accept-monero:steps.chooseSetup.title")}
        icon={appWindowIcon}
      >
        <p>{t("accept-monero:steps.chooseSetup.intro")}</p>

        <Accordion>
          <AccordionItem
            title={t("accept-monero:steps.chooseSetup.wallet.title")}
            variant="card"
            name="method"
            open
          >
            <p>
              {t("accept-monero:steps.chooseSetup.wallet.description")}
            </p>
            <IconLink
              href={localizeHref("/downloads/community/#wallets")}
              size="sm"
              underline
            >
              {t("accept-monero:steps.chooseSetup.wallet.viewWallets")}
            </IconLink>
          </AccordionItem>

          <AccordionItem
            title={t("accept-monero:steps.chooseSetup.pos.title")}
            variant="card"
            name="method"
          >
            <p>
              {t("accept-monero:steps.chooseSetup.pos.description")}
            </p>
            <div class="service-buttons">
              <ExternalResourceButton
                href="https://bitrequest.io/"
                title="BitRequest"
                subtitle={t(
                  "accept-monero:steps.chooseSetup.pos.services.bitrequest",
                )}
              />
              <ExternalResourceButton
                href="https://docs.btcpayserver.org/Apps/#point-of-sale-app"
                title="BTCPay Server POS"
                subtitle={t(
                  "accept-monero:steps.chooseSetup.pos.services.btcpayPos",
                )}
              />
            </div>
          </AccordionItem>

          <AccordionItem
            title={t("accept-monero:steps.chooseSetup.processor.title")}
            variant="card"
            name="method"
          >
            <p>
              {t("accept-monero:steps.chooseSetup.processor.description")}
            </p>
            <IconLink
              href={localizeHref("/resources/tools/accept/")}
              size="sm"
              underline
            >
              {t("accept-monero:steps.chooseSetup.processor.viewGateways")}
            </IconLink>
          </AccordionItem>

          <AccordionItem
            title={t("accept-monero:steps.chooseSetup.selfHosted.title")}
            variant="card"
            name="method"
          >
            <p>
              {t("accept-monero:steps.chooseSetup.selfHosted.description")}
            </p>
            <div class="service-buttons">
              <ExternalResourceButton
                href="https://btcpayserver.org/"
                title="BTCPay Server"
                subtitle={t(
                  "accept-monero:steps.chooseSetup.selfHosted.services.btcpay",
                )}
              />
              <ExternalResourceButton
                href="https://bitcart.ai/"
                title="Bitcart"
                subtitle={t(
                  "accept-monero:steps.chooseSetup.selfHosted.services.bitcart",
                )}
              />
              <ExternalResourceButton
                href="https://github.com/moneropay/moneropay"
                title="MoneroPay"
                subtitle={t(
                  "accept-monero:steps.chooseSetup.selfHosted.services.moneropay",
                )}
              />
            </div>
          </AccordionItem>
        </Accordion>
      </GuideStep>

      <hr />

      <GuideStep
        step={localizeNumber(2)}
        title={t("accept-monero:steps.acceptPayment.title")}
        icon={handCoinsIcon}
        reverse
      >
        <p>
          {t("accept-monero:steps.acceptPayment.description")}
        </p>
        <p>
          <strong
            >{t("accept-monero:steps.acceptPayment.confirmationsLabel")}</strong
          >
          {t("accept-monero:steps.acceptPayment.confirmations")}
        </p>
        <TipBox showIcon>
          {t("accept-monero:steps.acceptPayment.tip")}
        </TipBox>
      </GuideStep>

      <hr />

      <GuideStep
        step={localizeNumber(3)}
        title={t("accept-monero:steps.getListed.title")}
        icon={usersIcon}
      >
        <p>
          {t("accept-monero:steps.getListed.description")}
        </p>
        <IconLink
          href={localizeHref("/get-started/merchants")}
          size="sm"
          underline
        >
          {t("accept-monero:steps.getListed.viewDirectories")}
        </IconLink>
      </GuideStep>
    </div>
  </PageContainer>
</Layout>

<style>
  .guide-content :global(.guide-step:first-child) {
    align-items: start;
  }

  .service-buttons {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
    margin-top: var(--space-md);
  }

  .service-buttons :global(.external-resource-button) {
    border: 1px solid var(--border-color);
  }
</style>
