---
import Layout from "@/layouts/Layout.astro";

import TitleCard from "@/components/ui/TitleCard.astro";
import TOCContainer from "@/components/ui/TOCContainer.astro";

import appWindowIcon from "@/assets/icons/mask/app-window.avif";
import arrowRight from "@/assets/icons/mask/arrow-right.avif";
import bookTextIcon from "@/assets/icons/mask/bookText.avif";
import codeXmlIcon from "@/assets/icons/mask/codeXml.avif";
import externalLinkIcon from "@/assets/icons/mask/external-link.avif";
import globeIcon from "@/assets/icons/mask/globe.avif";
import handCoinsIcon from "@/assets/icons/mask/handCoins.avif";
import heartPlusIcon from "@/assets/icons/mask/heartPlus.avif";
import networkIcon from "@/assets/icons/mask/network.avif";
import pickaxeIcon from "@/assets/icons/mask/pickaxe.avif";
import piggyBankIcon from "@/assets/icons/mask/piggyBank.avif";
import serverIcon from "@/assets/icons/mask/server.avif";
import terminalIcon from "@/assets/icons/mask/terminal.avif";

import CoreProjectCard from "@/components/pages/contribute/CoreProjectCard.astro";
import ContentCard from "@/components/ui/ContentCard.astro";
import MaskIcon from "@/components/ui/MaskIcon.astro";
import PageContainer from "@/components/ui/PageContainer.astro";
import PageSection from "@/components/ui/PageSection.astro";
import { Image } from "astro:assets";

import contributingData from "@/data/contributing/contributing.json";

import { createTInstance, getLocale } from "@/i18n/utils";
import { createSafeMarkdown } from "@/utils/safeMarkdown";
const locale = getLocale(Astro.url);
const t = await createTInstance(locale);
const safeMarkdown = createSafeMarkdown(locale);

const sections = [
  {
    id: "supportTheNetwork",
    icon: networkIcon,
    title: t("contribute.sections.supportTheNetwork.title"),
    subtitle: t("contribute.sections.supportTheNetwork.subtitle"),
  },
  {
    id: "develop",
    icon: codeXmlIcon,
    title: t("contribute.sections.develop.title"),
    subtitle: t("contribute.sections.develop.subtitle"),
  },
  {
    id: "donate",
    icon: heartPlusIcon,
    title: t("contribute.sections.donate.title"),
    subtitle: t("contribute.sections.donate.subtitle"),
  },
];
---

<Layout
  title={t("contribute.pageTitle")}
  description={t("contribute.heroSubtitle")}
>
  <TitleCard
    title={t("contribute.heroTitle")}
    subtitle={t("contribute.heroSubtitle")}
  />

  <TOCContainer sections={sections} ariaLabel="On this page" />

  <PageContainer>
    <PageSection
      class="section"
      anchorId="supportTheNetwork"
      title={t("contribute.sections.supportTheNetwork.title")}
      subtitle={t("contribute.sections.supportTheNetwork.subtitle")}
    >
      <div class="gridTwo">
        <ContentCard
          title={t("contribute.sections.supportTheNetwork.runANode.title")}
          icon={serverIcon}
        >
          <p>
            {t("contribute.sections.supportTheNetwork.runANode.description")}
          </p>

          <div slot="bottom">
            <span class="title"
              >{
                t("contribute.sections.supportTheNetwork.runANode.guides")
              }</span
            >
            <ul>
              <li>
                <a
                  href="https://docs.getmonero.org/running-node/monerod-systemd/#debugging"
                  target="_blank"
                  rel="noopener"
                >
                  {
                    t(
                      "contribute.sections.supportTheNetwork.runANode.moneroDocs",
                    )
                  }
                  <MaskIcon src={arrowRight} size="1em" />
                </a>
              </li>
              <li>
                <a
                  href="https://sethforprivacy.com/guides/run-a-monero-node/"
                  target="_blank"
                  rel="noopener"
                >
                  {
                    t(
                      "contribute.sections.supportTheNetwork.runANode.sethForPrivacy",
                    )
                  }
                  <MaskIcon src={externalLinkIcon} size="1em" />
                </a>
              </li>
            </ul>
          </div>
        </ContentCard>

        <ContentCard
          title={t("contribute.sections.supportTheNetwork.mine.title")}
          icon={pickaxeIcon}
        >
          <p
            set:html={safeMarkdown.parseInline(
              t("contribute.sections.supportTheNetwork.mine.description"),
            )}
          />

          <div slot="bottom">
            <a href="/get-started/mining/" target="_blank" rel="noopener">
              {t("contribute.sections.supportTheNetwork.mine.learnAboutMining")}
              <MaskIcon src={arrowRight} size="1em" />
            </a>
          </div>
        </ContentCard>
      </div>
    </PageSection>

    <hr aria-hidden="true" />

    <PageSection
      class="section"
      anchorId="develop"
      title={t("contribute.sections.develop.title")}
      subtitle={t("contribute.sections.develop.subtitle")}
    >
      <h3>{t("contribute.sections.develop.coreProjects")}</h3>
      <div class="gridProjects">
        <CoreProjectCard
          title={t("contribute.sections.develop.daemon.title")}
          description={t("contribute.sections.develop.daemon.description")}
          tags={["C++"]}
          link="https://github.com/monero-project/monero"
          icon={terminalIcon}
        />
        <CoreProjectCard
          title={t("contribute.sections.develop.guiWallet.title")}
          description={t("contribute.sections.develop.guiWallet.description")}
          tags={["C++", "QML"]}
          link="https://github.com/monero-project/monero-gui"
          icon={appWindowIcon}
        />
        <CoreProjectCard
          title={t("contribute.sections.develop.moneroWebsite.title")}
          description={t(
            "contribute.sections.develop.moneroWebsite.description",
          )}
          tags={["Astro", "TypeScript"]}
          link="https://github.com/monero-project/monero-site"
          icon={globeIcon}
        />
        <CoreProjectCard
          title={t("contribute.sections.develop.moneroDocs.title")}
          description={t("contribute.sections.develop.moneroDocs.description")}
          tags={["Markdown"]}
          link="https://github.com/monero-project/monero-docs"
          icon={bookTextIcon}
        />
      </div>

      <h3>{t("contribute.sections.develop.additionalResources")}</h3>
      <ContentCard title={t("contribute.sections.develop.bounties.title")}>
        <p>
          {t("contribute.sections.develop.bounties.description")}
        </p>

        <div slot="bottom">
          <span class="title"
            >{t("contribute.sections.develop.bounties.links")}</span
          >
          <ul>
            <li>
              <a
                href="https://bounties.monero.social/"
                target="_blank"
                rel="noopener"
              >
                {t("contribute.sections.develop.bounties.browseMoneroBounties")}
                <MaskIcon src={externalLinkIcon} size="1em" />
              </a>
            </li>
            <li>
              <a
                href="https://hackerone.com/monero"
                target="_blank"
                rel="noopener"
              >
                {t("contribute.sections.develop.bounties.securityDisclosures")}
                <MaskIcon src={externalLinkIcon} size="1em" />
              </a>
            </li>
          </ul>
        </div>
      </ContentCard>
    </PageSection>

    <hr aria-hidden="true" />

    <PageSection
      class="section"
      anchorId="donate"
      title={t("contribute.sections.donate.title")}
      subtitle={t("contribute.sections.donate.subtitle")}
    >
      <div style="display: grid; gap: 1rem;">
        <ContentCard
          title={t(
            "contribute.sections.donate.communityCrowdfundingSystem.title",
          )}
          icon={handCoinsIcon}
        >
          <p>
            {
              t(
                "contribute.sections.donate.communityCrowdfundingSystem.description",
              )
            }
          </p>

          <div slot="bottom">
            <a
              href="https://ccs.getmonero.org/funding-required/"
              target="_blank"
              rel="noopener"
            >
              {
                t(
                  "contribute.sections.donate.communityCrowdfundingSystem.viewCcsProposals",
                )
              }
              <MaskIcon src={arrowRight} size="1em" />
            </a>
          </div>
        </ContentCard>

        <ContentCard
          title={t("contribute.sections.donate.generalFund.title")}
          icon={piggyBankIcon}
        >
          <p>
            {t("contribute.sections.donate.generalFund.description")}
          </p>

          <div class="donateGrid">
            <article>
              <h4>{t("contribute.sections.donate.generalFund.moneroXmr")}</h4>
              <div class="donateRow">
                <Image
                  class="image"
                  src={`/media/contributing/${contributingData.xmr.qr_filename}`}
                  alt="QR code for Monero donation"
                  width={220}
                  height={220}
                />
                <div>
                  <code>{contributingData.xmr.address}</code>

                  <details>
                    <summary
                      >{
                        t(
                          "contribute.sections.donate.generalFund.viewOnlyWalletDetails",
                        )
                      }</summary
                    >
                    <div>
                      <p>
                        <strong
                          >{
                            t(
                              "contribute.sections.donate.generalFund.primaryAddress",
                            )
                          }</strong
                        >
                      </p>
                      <code>{contributingData.xmr.view_address}</code>
                      <p>
                        <strong
                          >{
                            t("contribute.sections.donate.generalFund.viewKey")
                          }</strong
                        >
                      </p>
                      <code>{contributingData.xmr.view_key}</code>
                    </div>
                  </details>
                </div>
              </div>
            </article>

            <article>
              <h4>{t("contribute.sections.donate.generalFund.bitcoinBtc")}</h4>
              <div class="donateRow">
                <Image
                  class="image"
                  src={`/media/contributing/${contributingData.btc.qr_filename}`}
                  alt="QR code for Bitcoin donation"
                  width={220}
                  height={220}
                />
                <div>
                  <code>{contributingData.btc.address}</code>
                </div>
              </div>
            </article>
          </div>

          <p
            class="finePrint"
            set:html={safeMarkdown.parseInline(
              t("contribute.sections.donate.generalFund.fineprint", {
                openAlias: "donate.getmonero.org",
                email: "dev@getmonero.org",
              }),
            )}
          />
        </ContentCard>
      </div>
    </PageSection>
  </PageContainer>
</Layout>

<style>
  .gridTwo {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 1.25rem;
    align-items: stretch;
  }

  .gridProjects {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 1rem;
  }

  .donateGrid {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 1rem;
  }

  .donateRow {
    display: grid;
    grid-template-columns: 220px minmax(0, 1fr);
    gap: 1rem;
    align-items: start;
  }

  .donateGrid > article {
    background: var(--card-hover-color);
    border: 1px solid var(--border-color);
    border-radius: 0.5rem;
    padding: 1rem;
  }

  .donateGrid > article > h4 {
    margin: 0 0 0.75rem;
  }

  .donateRow .image {
    border-radius: 0.5rem;
    border: 1px solid var(--border-color);
  }

  .donateGrid code {
    display: block;
    border: 1px solid var(--border-color);
    background: rgba(0, 0, 0, 0.05);
    padding: 0.75rem;
    border-radius: 0.5rem;
    word-break: break-all;
    font-family: monospace;
    font-size: var(--font-size-sm);
  }

  .donateGrid details {
    border: 1px dashed var(--border-color);
    border-radius: 0.5rem;
    padding: 0.6rem 0.75rem;
    background: rgba(0, 0, 0, 0.02);
    margin-top: 1rem;
  }

  .donateGrid details summary {
    cursor: pointer;
    user-select: none;
    font-weight: var(--font-weight-bold);
  }

  .donateGrid details > div {
    margin-top: 0.75rem;
    display: grid;
    gap: 0.5rem;
  }

  .donateGrid details p {
    margin: 0;
  }

  .finePrint {
    color: var(--paragraph-subtitle);
    font-size: var(--font-size-sm);
    max-width: 80ch;
  }

  @media (max-width: 1200px) {
    .donateRow {
      grid-template-columns: minmax(0, 1fr);
      justify-items: center;
    }
  }

  @media (max-width: 900px) {
    .donateGrid,
    .gridTwo {
      grid-template-columns: minmax(0, 1fr);
    }
  }
</style>
