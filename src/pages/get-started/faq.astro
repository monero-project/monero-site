---
import "@/styles/moneropedia-link.css";

import Layout from "@/layouts/Layout.astro";

import AccordionCard from "@/components/pages/get-started/faq/AccordionCard.astro";
import IndexCard from "@/components/pages/index/IndexCard.astro";
import ResourceCard from "@/components/pages/index/ResourceCard.astro";
import type { AccordionItemType } from "@/components/ui/accordion/Accordion.astro";
import Grid from "@/components/ui/layout/Grid.astro";
import PageContainer from "@/components/ui/layout/PageContainer.astro";
import TitleCard from "@/components/ui/TitleCard.astro";

import developerGuidesIcon from "@/assets/icons/mask/developer-guides.avif";
import faqIcon from "@/assets/icons/mask/faq.avif";

const { t, safeMarkdown } = Astro.locals;

const sectionToItems = (
  section: Record<string, { title: string; content: string }>,
): AccordionItemType[] => {
  return Object.entries(section)
    .filter(([key]) => key !== "title")
    .map(([, item]) => ({
      title: item.title,
      content: safeMarkdown.parse(item.content),
    }));
};

const basicsItems = sectionToItems(
  t("faq:basics", { returnObjects: true }) as Record<
    string,
    { title: string; content: string }
  >,
);
const nodesItems = sectionToItems(
  t("faq:nodes", { returnObjects: true }) as Record<
    string,
    { title: string; content: string }
  >,
);
const privacyItems = sectionToItems(
  t("faq:privacy", { returnObjects: true }) as Record<
    string,
    { title: string; content: string }
  >,
);
const securityItems = sectionToItems(
  t("faq:security", { returnObjects: true }) as Record<
    string,
    { title: string; content: string }
  >,
);
const walletsItems = sectionToItems(
  t("faq:wallets", { returnObjects: true }) as Record<
    string,
    { title: string; content: string }
  >,
);
const economicsItems = sectionToItems(
  t("faq:economics", { returnObjects: true }) as Record<
    string,
    { title: string; content: string }
  >,
);
---

<Layout title={t("faq:pageTitle")} description={t("faq:hero.subtitle")}>
  <TitleCard title={t("faq:hero.title")} subtitle={t("faq:hero.subtitle")} />
  <PageContainer>
    <Grid columns={2} gap="lg" class="accordion-grid">
      <AccordionCard title={t("faq:basics.title")} items={basicsItems} />
      <AccordionCard title={t("faq:nodes.title")} items={nodesItems} />
      <AccordionCard title={t("faq:privacy.title")} items={privacyItems} />
      <AccordionCard title={t("faq:security.title")} items={securityItems} />
      <AccordionCard title={t("faq:wallets.title")} items={walletsItems} />
      <AccordionCard title={t("faq:economics.title")} items={economicsItems} />
    </Grid>
    <IndexCard
      title={t("faq:additionalResources.title")}
      description={t("faq:additionalResources.subtitle")}
      id="monero-resources"
    >
      <Grid minWidth="18rem" gap="2xl" class="resource-grid">
        <ResourceCard
          icon={developerGuidesIcon}
          title={t("faq:additionalResources.moneroDocs.title")}
          description={t("faq:additionalResources.moneroDocs.description")}
          ctaLabel={t("faq:additionalResources.moneroDocs.ctaLabel")}
          ctaHref="https://docs.getmonero.org"
        />
        <ResourceCard
          icon={faqIcon}
          title={t("faq:additionalResources.stackExchange.title")}
          description={t("faq:additionalResources.stackExchange.description")}
          ctaLabel={t("faq:additionalResources.stackExchange.ctaLabel")}
          ctaHref="https://monero.stackexchange.com"
        />
        <ResourceCard
          icon={developerGuidesIcon}
          title={t("faq:additionalResources.reddit.title")}
          description={t("faq:additionalResources.reddit.description")}
          ctaLabel={t("faq:additionalResources.reddit.ctaLabel")}
          ctaHref="https://www.reddit.com/r/MoneroSupport"
        />
        <ResourceCard
          icon={developerGuidesIcon}
          title={t("faq:additionalResources.monerohow.title")}
          description={t("faq:additionalResources.monerohow.description")}
          ctaLabel={t("faq:additionalResources.monerohow.ctaLabel")}
          ctaHref="https://monero.how"
        />
      </Grid>
    </IndexCard>
  </PageContainer>
</Layout>

<style>
  .accordion-grid {
    margin-bottom: var(--space-2xl);
  }

  .resource-grid {
    grid-column: span 2;
  }

  @media (width >= 900px) {
    .resource-grid {
      --grid-min-width: 25rem;
    }
  }
</style>
