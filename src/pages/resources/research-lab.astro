---
import PaperCard from "@/components/pages/resources/research-lab/PaperCard.astro";
import Button from "@/components/ui/Button.astro";
import HeroCard from "@/components/ui/HeroCard.astro";
import MaskIcon from "@/components/ui/MaskIcon.astro";
import PageContainer from "@/components/ui/PageContainer.astro";
import PageSection from "@/components/ui/PageSection.astro";
import SectionTabs from "@/components/ui/SectionTabs.astro";
import SidebarCard from "@/components/ui/SidebarCard.astro";
import SidebarLayout from "@/components/ui/SidebarLayout.astro";
import SidebarLink from "@/components/ui/SidebarLink.astro";
import Column from "@/components/ui/Column.astro";
import TitleCard from "@/components/ui/TitleCard.astro";
import Layout from "@/layouts/Layout.astro";

import bookTextIcon from "@/assets/icons/mask/bookText.avif";
import externalLinkIcon from "@/assets/icons/mask/external-link.avif";
import hashtagIcon from "@/assets/icons/mask/hashtag.avif";

import mrlLogo from "@/assets/images/mrl-logo.avif";

const { dir, t, localizeHref } = Astro.locals;

import {
  iacrPapers,
  mrlBulletins,
  otherPapers,
  whitepapers,
} from "@/data/research-lab";

const paperTabs = [
  {
    label: t("knowledge-base:researchLab.papers.tabs.mrlBulletins"),
    count: mrlBulletins.length,
  },
  {
    label: t("knowledge-base:researchLab.papers.tabs.iacr"),
    count: iacrPapers.length,
  },
  {
    label: t("knowledge-base:researchLab.papers.tabs.other"),
    count: otherPapers.length,
  },
];
---

<Layout
  title={t("knowledge-base:researchLab.pageTitle")}
  description={t("knowledge-base:researchLab.subtitle")}
>
  <TitleCard
    title={t("knowledge-base:researchLab.title")}
    subtitle={t("knowledge-base:researchLab.subtitle")}
    backHref={localizeHref("/resources/knowledge-base/")}
    backLabel={t("knowledge-base:index.title")}
  />

  <PageContainer>
    <HeroCard
      image={mrlLogo}
      imageAlt={t("knowledge-base:researchLab.hero.imageAlt")}
      title={t("knowledge-base:researchLab.hero.title")}
      description={t("knowledge-base:researchLab.hero.description")}
    >
      <Button
        href="https://moneroresearch.info/"
        as="a"
        target="_blank"
        rel="noopener noreferrer"
      >
        MoneroResearch.info
        <MaskIcon src={externalLinkIcon} size="1em" rtl={dir === "rtl"} />
      </Button>
      <Button
        href="https://matrix.to/#/#monero-research-lab:monero.social"
        as="a"
        target="_blank"
        rel="noopener noreferrer"
        variant="secondary"
      >
        Matrix
        <MaskIcon src={externalLinkIcon} size="1em" rtl={dir === "rtl"} />
      </Button>
      <Button
        as="a"
        href="https://web.libera.chat/#monero-research-lab"
        target="_blank"
        rel="noopener noreferrer"
        variant="secondary"
      >
        <MaskIcon src={hashtagIcon} size="0.9em" rtl={dir === "rtl"} />
        IRC
      </Button>
    </HeroCard>

    <hr aria-hidden="true" />

    <PageSection
      title={t("knowledge-base:researchLab.papers.title")}
      subtitle={t("knowledge-base:researchLab.papers.subtitle")}
      anchorId="papers"
    >
      <SidebarLayout>
        <SectionTabs tabs={paperTabs}>
          <Column slot="panel-0" gap="sm">
            {
              mrlBulletins.map((paper) => (
                <PaperCard
                  code={paper.code}
                  title={paper.title}
                  abstract={paper.abstract}
                  url={paper.url}
                  note={paper.note}
                />
              ))
            }
          </Column>
          <Column slot="panel-1" gap="sm">
            {
              iacrPapers.map((paper) => (
                <PaperCard
                  code={paper.code}
                  title={paper.title}
                  abstract={paper.abstract}
                  url={paper.url}
                  note={paper.note}
                />
              ))
            }
          </Column>
          <Column slot="panel-2" gap="sm">
            {
              otherPapers.map((paper) => (
                <PaperCard
                  code={paper.code}
                  title={paper.title}
                  abstract={paper.abstract}
                  url={paper.url}
                  note={paper.note}
                />
              ))
            }
          </Column>
        </SectionTabs>

        <SidebarCard
          slot="sidebar"
          title={t("knowledge-base:researchLab.whitepapers.title")}
          subtitle={t("knowledge-base:researchLab.whitepapers.subtitle")}
        >
          {
            whitepapers.map((paper) => (
              <SidebarLink href={paper.url} icon={bookTextIcon} external>
                {t(`knowledge-base:researchLab.whitepapers.items.${paper.id}`)}
              </SidebarLink>
            ))
          }
        </SidebarCard>
      </SidebarLayout>
    </PageSection>
  </PageContainer>
</Layout>
