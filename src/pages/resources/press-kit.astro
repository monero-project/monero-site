---
import Button from "@/components/ui/Button.astro";
import ExternalResourceButton from "@/components/ui/ExternalResourceButton.astro";
import MaskIcon from "@/components/ui/MaskIcon.astro";
import PageContainer from "@/components/ui/PageContainer.astro";
import PageSection from "@/components/ui/PageSection.astro";
import PageSectionColumn from "@/components/ui/PageSectionColumn.astro";
import TitleCard from "@/components/ui/TitleCard.astro";
import TOCContainer from "@/components/ui/TOCContainer.astro";
import Layout from "@/layouts/Layout.astro";
import { Image } from "astro:assets";

import arrowRightIcon from "@/assets/icons/mask/arrow-right.avif";
import bookTextIcon from "@/assets/icons/mask/bookText.avif";
import componentIcon from "@/assets/icons/mask/component.avif";
import usersIcon from "@/assets/icons/mask/users.avif";

import {
  brandAssets,
  marketingResources,
  pressDocuments,
} from "@/data/press-kit";
import { getPublicImageDimensions } from "@/utils/image";

const { dir, t, localizeHref } = Astro.locals;
const previewDimensions = await Promise.all(
  brandAssets.map((asset) => getPublicImageDimensions(asset.preview)),
);

const sections = [
  {
    id: "brand-assets",
    icon: componentIcon,
    title: t("press-kit:sections.brandAssets.title"),
    subtitle: t("press-kit:sections.brandAssets.tocSubtitle"),
  },
  {
    id: "press-materials",
    icon: bookTextIcon,
    title: t("press-kit:sections.pressMaterials.title"),
    subtitle: t("press-kit:sections.pressMaterials.tocSubtitle"),
  },
  {
    id: "contacts",
    icon: usersIcon,
    title: t("press-kit:sections.contacts.title"),
    subtitle: t("press-kit:sections.contacts.tocSubtitle"),
  },
];
---

<Layout
  title={t("press-kit:pageTitle")}
  description={t("press-kit:description")}
>
  <TitleCard title={t("press-kit:title")} subtitle={t("press-kit:subtitle")} />

  <PageContainer>
    <TOCContainer
      sections={sections}
      ariaLabel={t("press-kit:aria.sectionsNav")}
    />

    <div class="press-content">
      <PageSection
        title={t("press-kit:sections.brandAssets.title")}
        anchorId="brand-assets"
      >
        <p class="section-intro">
          {t("press-kit:sections.brandAssets.intro")}
        </p>

        <div class="assets-grid">
          {
            brandAssets.map((asset, i) => (
              <div class="asset-card">
                <div class="asset-preview">
                  <Image
                    src={asset.preview}
                    alt=""
                    width={previewDimensions[i].width}
                    height={previewDimensions[i].height}
                  />
                </div>

                <div class="asset-header">
                  <h3>{t(`press-kit:assets.${asset.id}.name`)}</h3>
                  <p>{t(`press-kit:assets.${asset.id}.description`)}</p>
                </div>

                <div class="asset-variants">
                  {asset.variants.map((variant) => (
                    <div class="variant-group">
                      <span class="variant-label">
                        {t(`press-kit:assets.variants.${variant.labelKey}`)}
                      </span>
                      <div class="size-links">
                        {variant.sizes.map((size) => (
                          <a
                            href={size.url}
                            class="size-link"
                            download
                            target="_blank"
                            rel="noopener noreferrer"
                          >
                            {t(`press-kit:assets.sizes.${size.labelKey}`)}
                          </a>
                        ))}
                      </div>
                    </div>
                  ))}
                </div>

                {asset.vectorUrl && (
                  <div class="vector-download">
                    <Button as="a" href={asset.vectorUrl} variant="secondary">
                      {t("press-kit:sections.brandAssets.downloadVector")}
                    </Button>
                  </div>
                )}
              </div>
            ))
          }
        </div>

        <div class="download-all">
          <Button
            href="/media/press-kit/monero-press-kit.zip"
            variant="primary"
          >
            {t("press-kit:sections.brandAssets.downloadAll")}
          </Button>
        </div>
      </PageSection>

      <hr aria-hidden="true" />

      <PageSection
        title={t("press-kit:sections.pressMaterials.title")}
        anchorId="press-materials"
      >
        <PageSectionColumn columns={2}>
          <PageSectionColumn
            title={t("press-kit:sections.pressMaterials.pressDocumentation")}
          >
            <div class="resource-list">
              {
                pressDocuments.map((doc) => (
                  <ExternalResourceButton
                    href={doc.url}
                    title={t(`press-kit:documents.${doc.id}.title`)}
                    subtitle={t(`press-kit:documents.${doc.id}.description`)}
                  />
                ))
              }
            </div>
          </PageSectionColumn>

          <PageSectionColumn
            title={t("press-kit:sections.pressMaterials.marketingMaterials")}
          >
            <div class="resource-list">
              {
                marketingResources.map((resource) => (
                  <ExternalResourceButton
                    href={resource.url}
                    title={t(`press-kit:marketing.${resource.id}.title`)}
                    subtitle={t(
                      `press-kit:marketing.${resource.id}.description`,
                    )}
                  />
                ))
              }
            </div>
          </PageSectionColumn>
        </PageSectionColumn>
      </PageSection>

      <hr aria-hidden="true" />

      <PageSection
        title={t("press-kit:sections.contacts.title")}
        anchorId="contacts"
      >
        <div class="contact-grid">
          <div class="contact-card">
            <h3>{t("press-kit:sections.contacts.pressInquiries.title")}</h3>
            <p>{t("press-kit:sections.contacts.pressInquiries.description")}</p>
            <a href="mailto:press@getmonero.org" class="contact-link">
              press@getmonero.org
            </a>
          </div>
          <div class="contact-card">
            <h3>{t("press-kit:sections.contacts.workgroups.title")}</h3>
            <p>{t("press-kit:sections.contacts.workgroups.description")}</p>
            <a
              href={localizeHref("/community/workgroups")}
              class="contact-link"
            >
              {t("press-kit:sections.contacts.workgroups.link")}
              <MaskIcon src={arrowRightIcon} rtl={dir === "rtl"} />
            </a>
          </div>
          <div class="contact-card">
            <h3>{t("press-kit:sections.contacts.community.title")}</h3>
            <p>{t("press-kit:sections.contacts.community.description")}</p>
            <a href={localizeHref("/community/hangouts")} class="contact-link">
              {t("press-kit:sections.contacts.community.link")}
              <MaskIcon src={arrowRightIcon} rtl={dir === "rtl"} />
            </a>
          </div>
        </div>
      </PageSection>
    </div>
  </PageContainer>
</Layout>

<style>
  .press-content {
    display: flex;
    flex-direction: column;
  }

  .contact-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(min(18rem, 100%), 1fr));
    gap: 1rem;
  }

  .contact-card {
    background: var(--card-color);
    border-radius: 0.5rem;
    padding: 1.5rem;
  }

  .contact-card h3 {
    margin: 0 0 0.5rem;
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
  }

  .contact-card p {
    margin: 0 0 0.75rem;
    color: var(--paragraph-subtitle);
    font-size: var(--font-size-sm);
  }

  .contact-link {
    display: inline-flex;
    align-items: center;
    gap: 0.35em;
    font-weight: var(--font-weight-bold);
  }

  .section-intro {
    color: var(--paragraph-subtitle);
    margin: 0 0 1.5rem;
    max-width: 70ch;
  }

  .download-all {
    margin-top: 2rem;
    display: flex;
    justify-content: flex-end;
  }

  .assets-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(min(22rem, 100%), 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .asset-card {
    background: var(--card-color);
    border-radius: 0.5rem;
    padding: 1.5rem;
  }

  .asset-preview {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1.5rem;
    margin-bottom: 1.25rem;
    background: repeating-conic-gradient(#e4e1e9 0% 25%, #f9f7fc 0% 50%) 50% /
      16px 16px;
    border-radius: 0.5rem;
  }

  .asset-preview img {
    max-width: 100%;
    max-height: 6rem;
    object-fit: contain;
  }

  .asset-header {
    margin-bottom: 1.25rem;
  }

  .asset-header h3 {
    margin: 0 0 0.25rem;
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
  }

  .asset-header p {
    margin: 0;
    color: var(--paragraph-subtitle);
    font-size: var(--font-size-sm);
  }

  .asset-variants {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .variant-group {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.5rem;
  }

  .variant-label {
    font-size: var(--font-size-sm);
    color: var(--paragraph-main);
    font-weight: var(--font-weight-medium);
    min-width: 10rem;
  }

  .size-links {
    display: flex;
    gap: 1rem;
  }

  .size-link {
    font-size: var(--font-size-sm);
  }

  .vector-download {
    margin-top: 1.25rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-color);
  }

  .resource-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }
</style>
