---
import BookCard from "@/components/pages/resources/library/BookCard.astro";
import CheatsheetCard from "@/components/pages/resources/library/CheatsheetCard.astro";
import ExternalResourceButton from "@/components/ui/ExternalResourceButton.astro";
import Grid from "@/components/ui/layout/Grid.astro";
import PageContainer from "@/components/ui/layout/PageContainer.astro";
import PageSection from "@/components/ui/layout/PageSection.astro";
import Column from "@/components/ui/layout/Column.astro";
import TitleCard from "@/components/ui/TitleCard.astro";
import TOCContainer from "@/components/ui/toc/TOCContainer.astro";
import Layout from "@/layouts/Layout.astro";

import { books, cheatsheets, newsletters } from "@/data/resources/library";
import { icons } from "@/utils/icons";

const { dir, t, localizeHref } = Astro.locals;

const sections = [
  {
    id: "books",
    icon: icons.mask("book-text"),
    title: t("knowledge-base:library.sections.books.title"),
    subtitle: t("knowledge-base:library.sections.books.tocSubtitle"),
  },
  {
    id: "cheatsheets",
    icon: icons.mask("receipt-text"),
    title: t("knowledge-base:library.sections.cheatsheets.title"),
    subtitle: t("knowledge-base:library.sections.cheatsheets.tocSubtitle"),
  },
  {
    id: "newsletters",
    icon: icons.mask("mails"),
    title: t("knowledge-base:library.sections.newsletters.title"),
    subtitle: t("knowledge-base:library.sections.newsletters.tocSubtitle"),
  },
];
---

<Layout
  title={t("knowledge-base:library.pageTitle")}
  description={t("knowledge-base:library.subtitle")}
>
  <TitleCard
    title={t("knowledge-base:library.title")}
    subtitle={t("knowledge-base:library.subtitle")}
    backHref={localizeHref("/resources/knowledge-base/")}
    backLabel={t("knowledge-base:index.title")}
  />

  <PageContainer>
    <TOCContainer
      sections={sections}
      ariaLabel={t("knowledge-base:library.aria.sectionsNav")}
    />
    <PageSection
      title={t("knowledge-base:library.sections.books.title")}
      subtitle={t("knowledge-base:library.sections.books.subtitle")}
      anchorId="books"
    >
      <Grid columns={2} gap="md">
        {books.map((book) => <BookCard {...book} />)}
      </Grid>
    </PageSection>

    <hr aria-hidden="true" />

    <PageSection
      title={t("knowledge-base:library.sections.cheatsheets.title")}
      anchorId="cheatsheets"
    >
      <div class="cheatsheet-intro">
        <h3 class="salmon-title">
          {t("knowledge-base:library.sections.cheatsheets.salmonSeries.title")}
        </h3>
        <p class="section-intro">
          {
            t(
              "knowledge-base:library.sections.cheatsheets.salmonSeries.description",
            )
          }
        </p>
      </div>

      <Grid minWidth="16rem" gap="md">
        {
          cheatsheets.map((sheet) => (
            <CheatsheetCard
              url={sheet.url}
              title={sheet.title}
              description={sheet.description}
              icon={icons.mask("receipt-text")}
              rtl={dir === "rtl"}
            />
          ))
        }
      </Grid>
    </PageSection>

    <hr aria-hidden="true" />

    <PageSection
      title={t("knowledge-base:library.sections.newsletters.title")}
      subtitle={t("knowledge-base:library.sections.newsletters.subtitle")}
      anchorId="newsletters"
    >
      <Column gap="sm">
        {
          newsletters.map((newsletter) => (
            <ExternalResourceButton
              href={newsletter.url}
              title={newsletter.title}
              subtitle={newsletter.description}
            />
          ))
        }
      </Column>
    </PageSection>
  </PageContainer>
</Layout>

<style>
  .section-intro {
    color: var(--paragraph-subtitle);
    margin-block: 0 var(--space-xl);
    max-width: 70ch;
    line-height: var(--line-height-body);
  }

  .cheatsheet-intro {
    margin-bottom: var(--space-xl);
  }

  .salmon-title {
    margin-block: var(--space-xs);
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--heading-color);
  }
</style>
