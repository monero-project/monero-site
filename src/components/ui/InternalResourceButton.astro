---
import Card from "./Card.astro";
import MaskIcon from "./icons/MaskIcon.astro";
import type { ImageMetadata } from "astro";
import { icons } from "@/utils/icons";

interface Props {
  icon?: ImageMetadata;
  title: string;
  href?: string;
}

const { icon, title, href } = Astro.props;
const rtl = Astro.locals.dir === "rtl";
---

<Card
  as={href ? "a" : "div"}
  padding="sm"
  hover={!!href}
  class="info-bar"
  href={href || undefined}
  aria-label={href ? title : undefined}
>
  {
    icon && (
      <span class="info-icon" aria-hidden="true">
        <MaskIcon src={icon} size="1.5em" aria-hidden="true" />
      </span>
    )
  }

  <div class="info-content">
    <span class="info-title">{title}</span>
    <div class="info-description">
      <slot />
    </div>
  </div>

  {
    href && (
      <span class="info-arrow" aria-hidden="true">
        <MaskIcon
          src={icons.mask("arrow-right")}
          size="1.25em"
          aria-hidden="true"
          rtl={rtl}
        />
      </span>
    )
  }
</Card>

<style>
  .info-bar {
    position: relative;
    margin: var(--space-md) 0;
    display: flex;
    align-items: center;
    gap: var(--space-md);
    text-decoration: none;
    color: inherit;
  }

  .info-icon {
    color: var(--monero-orange);
    flex-shrink: 0;
    display: flex;
    align-self: center;
  }

  .info-content {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
    min-width: 0;

    .info-title {
      margin: 0;
      font-size: var(--font-size-md);
      font-weight: var(--font-weight-semibold);
      color: var(--heading-color);
    }

    .info-description {
      margin: 0;
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
    }
  }

  .info-arrow {
    color: var(--monero-orange);
    flex-shrink: 0;
    display: flex;
    margin-inline-start: auto;
    opacity: 0.8;
    transition: opacity 0.15s ease;
  }

  a.info-bar {
    &:hover .info-arrow,
    &:focus-visible .info-arrow {
      opacity: 1;
    }

    &:focus-visible {
      outline: 2px solid var(--monero-orange);
      outline-offset: 2px;
    }
  }
</style>
