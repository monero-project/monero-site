---
import MaskIcon from "@/components/ui/icons/MaskIcon.astro";
import { Image } from "astro:assets";
import { icons } from "@/utils/icons";

interface Props {
  currency: string;
  address: string;
  qrCode: string;
  viewAddress?: string;
  viewKey?: string;
  viewOnlyLabel?: string;
  primaryAddressLabel?: string;
  viewKeyLabel?: string;
}

const {
  currency,
  address,
  qrCode,
  viewAddress,
  viewKey,
  viewOnlyLabel = "View-only wallet details",
  primaryAddressLabel = "Primary address",
  viewKeyLabel = "View Key",
} = Astro.props;
---

<div class="donation-address">
  <div class="address-header">
    <h4 class="currency-name">{currency}</h4>
  </div>

  <div class="address-content">
    <Image
      class="qr-code"
      src={qrCode}
      alt={`QR code for ${currency} donation`}
      width={200}
      height={200}
      format="avif"
    />
    <div class="address-details">
      <code class="address">{address}</code>

      {
        viewAddress && viewKey && (
          <details class="view-only-details">
            <summary>
              <span class="icon">
                <MaskIcon src={icons.mask("chevron-down")} size="0.875em" />
              </span>
              <span>{viewOnlyLabel}</span>
            </summary>
            <div class="view-only-content">
              <p>
                <strong>{primaryAddressLabel}</strong>
              </p>
              <code>{viewAddress}</code>
              <p>
                <strong>{viewKeyLabel}</strong>
              </p>
              <code>{viewKey}</code>
            </div>
          </details>
        )
      }
    </div>
  </div>
</div>

<style>
  .donation-address {
    background: var(--card-hover-color);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-lg);
    padding: var(--space-md);
  }

  .currency-name {
    margin: 0 0 var(--space-sm);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-bold);
    color: var(--heading-color);
  }

  .address-content {
    display: flex;
    gap: var(--space-md);
    align-items: flex-start;
  }

  .qr-code {
    border-radius: var(--radius-md);
    border: 1px solid var(--border-color);
    flex-shrink: 0;
  }

  .address-details {
    flex: 1;
    min-width: 0;
  }

  .address {
    flex: 1;
    display: block;
    padding: var(--space-xs) var(--space-sm);
    background: rgb(0 0 0 / 5%);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    font-family: monospace;
    font-size: var(--font-size-sm);
    word-break: break-all;
    line-height: 1.4;
  }

  .view-only-details {
    margin-top: var(--space-sm);
    border: 1px dashed var(--border-color);
    border-radius: var(--radius-md);
    padding: var(--space-xs) var(--space-sm);
    background: rgb(0 0 0 / 2%);

    & summary {
      display: flex;
      align-items: center;
      gap: var(--space-xs);
      list-style: none;
      cursor: pointer;
      user-select: none;
      font-weight: var(--font-weight-semibold);
      color: var(--paragraph-subtitle);

      &::-webkit-details-marker {
        display: none;
      }
    }

    .icon {
      display: inline-flex;
      transition: transform 0.2s ease;
    }

    &[open] .icon {
      transform: rotate(180deg);
    }
  }

  .view-only-content {
    margin-top: var(--space-sm);
    display: grid;
    gap: var(--space-2xs);

    & p {
      margin: 0;
    }

    & code {
      display: block;
      padding: var(--space-xs) var(--space-sm);
      background: rgb(0 0 0 / 5%);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      font-family: monospace;
      font-size: var(--font-size-sm);
      word-break: break-all;
      line-height: 1.4;
    }
  }

  @media (width <= 600px) {
    .address-content {
      flex-direction: column;
      align-items: center;
    }

    .address-details {
      width: 100%;
    }
  }
</style>
